---
title: jvm特性（二）GC
date: 2020-02-20 17:30:27
categories:
- Java进阶
---

# 垃圾回收算法
<!--more-->

### 引用计数
给对象添加一个引用计数器，有一个地方引用就+1，引用失效-1，当引用为0时，则没有引用可以被回收。
问题：两个对象相互循环引用，没有其他引用时，这两个对象永远不会被回收。

### 可达性分析
用GC Roots对象作为起始点，从这些节点往下搜索，所有在引用链上的对象都是可达的，所以当一个对象没有在GC Roots对象引用链上时就可以被回收了。

GC Roots对象来自:
* 虚拟机栈中引用的对象
* 方法区中类静态属性引用的对象
* 方法区中常量引用的对象
* 本地方法中的JNI引用的对象

##### 引用
* 强引用
* 软引用SoftReference
* 弱引用WeakReference
* 虚引用PhantomReference

##### finalize()方法
对象不在GC Roots引用链  -->  筛选是否有必要执行finalize()方法  -->  对象放置到F-Queue队列，由低级别线程执行方法，并且是异步的，不等方法执行完
  --> GC对队列中的对象进行第二次标记，若还不在GC Roots，则被标记需要被清理的对象 
  
  对象的finalize()方法只会被执行一次
  
  
  
# 垃圾收集算法

### 标记-清除算法
先标记，再清除

缺点：大量不连续的内存碎片，效率不高


### 复制算法
分两块内存空间，一个空间内存活的对象复制到另一块内存空间，然后将原来的内存空间清理。

缺点：内存使用率不高
这种算法分为Eden，From Survivor，To Survivor3个空间


### 标记-整理算法
先标记，然后让对象都向内存一端移动形成一块连续的内存空间，然后清理掉其他空间的对象

### 分代收集算法
新生代和老年代















###