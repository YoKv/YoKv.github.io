---
title: 工厂模式
date: 2017-08-03 21:30:37
categories:
- 设计模式
---

## 工厂模式

*工厂模式：*定义一个创建对象的接口，但由子类决定要实例化的类是哪一个。工厂方法让类吧实例化推迟到子类。

<!--more-->
TODO
## 代码

### 披萨
```java
public abstract class Pizza {
    String name;
    String dough;
    String sauce;
    ArrayList toppings = new ArrayList();

    public void prepare() {
        System.out.println("name" + name);
        System.out.println("dough" + dough);
        System.out.println("sauce" + sauce);
        System.out.println("toppings" + toppings);

    }

    public void bake() {
        System.out.println("bake");
    }

    public void cut() {
        System.out.println("cut");
    }

    public void box() {
        System.out.println("box");
    }

    public String getName() {
        return name;
    }
}


```
```java
public class NYStyleCheesePizza extends Pizza {

}


```
```java
public class CheesePizza extends Pizza {

}
```


### 简单工厂

简单工厂将判断提取到一个单独的类中
```java
public class SimplePizzaFactory {

    public Pizza createPizza(String type) {
        Pizza pizza = null;
        switch (type) {
            case "cheese":
                pizza = new CheesePizza();
                break;
            default:
                break;
        }

        return pizza;
    }

}
```

```java
public class SimplePizzaStore {
    SimplePizzaFactory simplePizzaFactory;

    public SimplePizzaStore(SimplePizzaFactory simplePizzaFactory) {
        this.simplePizzaFactory = simplePizzaFactory;
    }

    public Pizza orderPizza(String type) {
        Pizza pizza = simplePizzaFactory.createPizza(type);
        pizza.prepare();
        pizza.bake();
        pizza.cut();
        pizza.box();
        return pizza;
    }


}
```

### 工厂

```java
public abstract class PizzaStore {
    abstract Pizza createPizza(String type);

    public Pizza orderPizza(String type) {
        Pizza pizza = createPizza(type);
        pizza.prepare();
        pizza.bake();
        pizza.cut();
        pizza.box();
        return pizza;
    }


}


```



```java
public class NYPizzaStore extends PizzaStore {
    @Override
    Pizza createPizza(String type) {
        Pizza pizza = null;
        switch (type) {
            case "cheese":
                pizza = new CheesePizza();
                break;
            default:
                break;
        }

        return pizza;
    }


}

```



```java
public class ChicagoPizzaStore extends PizzaStore {
    @Override
    Pizza createPizza(String type) {
        Pizza pizza = null;
        switch (type) {
            case "cheese":
                pizza = new CheesePizza();
                break;
            default:
                break;
        }

        return pizza;
    }

}

```



```java
    @Test
    public void factoryTest() {
        PizzaStore NYPizzaStore = new NYPizzaStore();
        PizzaStore chicagoPizzaStore = new ChicagoPizzaStore();
        Pizza pizza = NYPizzaStore.orderPizza("cheese");
        System.out.println(pizza.getName());
        pizza = chicagoPizzaStore.orderPizza("cheese");
        System.out.println(pizza.getName());

    }
```




### 抽象工厂


```java
public abstract class AbstractPizza {
    String name;
    Dough dough;
    Sauce sauce;
    Cheese cheese;
    Veggies veggies[];
    Pepperoni pepperoni;
    Clams clams;

    public abstract void prepare();

    public void bake() {
        System.out.println("bake");
    }

    public void cut() {
        System.out.println("cut");
    }

    public void box() {
        System.out.println("box");
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }

    @Override
    public String toString() {
        return "AbstractPizza{" +
                "name='" + name + '\'' +
                ", dough=" + dough +
                ", sauce=" + sauce +
                ", veggies=" + Arrays.toString(veggies) +
                ", pepperoni=" + pepperoni +
                ", clams=" + clams +
                '}';
    }
}
```



```java
public class AbstractClamPizza extends AbstractPizza {
    PizzaIngredientFactory ingredientFactory;

    public AbstractClamPizza(PizzaIngredientFactory ingredientFactory) {
        this.ingredientFactory = ingredientFactory;
    }

    @Override
    public void prepare() {
        System.out.println("prepare " + name);
        dough = ingredientFactory.createDough();
        sauce = ingredientFactory.createSauce();
        cheese = ingredientFactory.createCheese();
        clams = ingredientFactory.createClams();
    }
}

```



```java
public class AbstractCheesePizza extends AbstractPizza {
    PizzaIngredientFactory ingredientFactory;

    public AbstractCheesePizza(PizzaIngredientFactory ingredientFactory) {
        this.ingredientFactory = ingredientFactory;
    }

    @Override
    public void prepare() {
        System.out.println("prepare " + name);
        dough = ingredientFactory.createDough();
        sauce = ingredientFactory.createSauce();
        cheese = ingredientFactory.createCheese();
    }
}

```


```java
public abstract class AbstractPizzaStore {
    abstract AbstractPizza createPizza(String type);

    public AbstractPizza orderPizza(String type) {
        AbstractPizza pizza = createPizza(type);
        pizza.prepare();
        pizza.bake();
        pizza.cut();
        pizza.box();
        return pizza;
    }


}

```


```java
public class AbstractNYPizzaStore extends AbstractPizzaStore {
    @Override
    AbstractPizza createPizza(String item) {
        AbstractPizza pizza = null;
        PizzaIngredientFactory ingredientFactory = new NYPizzaIngredientFactory();
        switch (item) {
            case "cheese":
                pizza = new AbstractCheesePizza(ingredientFactory);
                break;
            default:
                break;
        }

        return pizza;
    }


}
```


```java
public interface PizzaIngredientFactory {
    Dough createDough();

    Cheese createCheese();

    Clams createClams();

    Pepperoni createPepperoni();

    Sauce createSauce();

    Veggies[] createVeggies();
}
```


```java
public class NYPizzaIngredientFactory implements PizzaIngredientFactory {
    @Override
    public Dough createDough() {
        return new Dough11();
    }

    @Override
    public Cheese createCheese() {
        return new Cheese11();
    }

    @Override
    public Clams createClams() {
        return new Clams11();
    }

    @Override
    public Pepperoni createPepperoni() {
        return new Pepperoni11();
    }

    @Override
    public Sauce createSauce() {
        return new Sauce11();
    }

    @Override
    public Veggies[] createVeggies() {
        Veggies veggies[] = {new Veggies11(), new Veggies12()};
        return veggies;
    }
}
```
```java
public class ChicagoPizzaIngredientFactory implements PizzaIngredientFactory {
    @Override
    public Dough createDough() {
        return new Dough12();
    }

    @Override
    public Cheese createCheese() {
        return new Cheese12();
    }

    @Override
    public Clams createClams() {
        return new Clams12();
    }

    @Override
    public Pepperoni createPepperoni() {
        return new Pepperoni12();
    }

    @Override
    public Sauce createSauce() {
        return new Sauce12();
    }

    @Override
    public Veggies[] createVeggies() {
        Veggies veggies[] = {new Veggies11(), new Veggies12()};
        return veggies;
    }
}
```
